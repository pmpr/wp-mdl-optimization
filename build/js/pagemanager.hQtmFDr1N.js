/*! For license information please see pagemanager.hQtmFDr1N.js.LICENSE.txt */
(()=>{var e={510:(e,t,a)=>{"use strict";a.r(t)}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,a),s.exports}a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a(510),function(){const e=PRHelper.getHTML(),t=PRHelper.getType(),a=PRHelper.getHook(),r=PRHelper.getForm(),n=PRHelper.getFormat(),s=PRHelper.getSetting(),o=PRHelper.getRequest(),l=PRBackendHelper.getForm(),i=PRBackendHelper.getModal(),p={onFinish:t=>{const a=t.getData("html");a&&e.fadeIn(t.element,{start:()=>{e.replace(a,t.element,!0)}})},onFail:t=>{const a=t.getData("html");a&&e.fadeIn(t.element,{start:()=>{e.replace(a,t.element,!0)}})}},g=(n.parseArgs({validator:t=>new Promise(((a,r)=>{o.ajax(s.getOption("pagemanager.ajax.check_preload")).addNonce().onSuccess((e=>{"in-progress"!==e.status?(t.addData("html",e.html),a(!0)):a(!1)})).onError((e=>{a(!0)})).send({pattern:e.getData(t.element,"pattern")})}))},p),n.parseArgs({validator:t=>new Promise(((a,r)=>{o.ajax(s.getOption("pagemanager.ajax.check_pattern_run")).addNonce().onSuccess((e=>{"in-progress"!==e.status?(t.addData("html",e.html),a(!0)):a(!1)})).onError((e=>{a(!0)})).send({pattern:e.getData(t.element,"pattern")})}))},p));function c(r,l){a.bubbling("click",(a=>{let p=e.getTarget(a,`.opt-pattern-${r}`),c=p.closest(".pr-modal-container");e.setElementActivity(p,!1),o.ajax(s.getOption(`pagemanager.ajax.${l}_pattern`)).addNonce().onSuccess((a=>{if(t.isEmpty(a.progressbar))window.location.reload();else{const t=e.getParent(p,"tr"),r=e.getElement(".latest_run_status",t);e.fadeIn(r,{start:()=>{e.replace(a.progressbar,r)}});const n=e.getElement(".pr-progress",r);PRProgress.start(n,PRHelper.getFormat().parseArgs({onStart:()=>{i.getCurrent().close()}},g))}})).onError((e=>{i.getCurrent().showMessage(n.error2string(e))})).onFinally((()=>{e.setElementActivity(p,!0)})).send({link:e.getValue(e.getElement("input[name=candidate_page_link]",c)),pattern:e.getData(p,"pattern")})}),`.opt-pattern-${r}`)}PRProgress.startAll(g),a.on("change paste input",(a=>{let i=e.getTarget(a,"input");r.getFieldContainer(i),r.inputDelay(i,(()=>{let a=e.getValue(i),r=i.closest(".pr-modal-container"),p=e.getElement(".opt-pattern-optimize",r);if(t.isEmpty(a))e.setElementActivity(p,!0,!1);else if(!n.isURL(a)||n.isExternalURL(a))l.showFieldMessage(i,s.getOption("pagemanager.invalid_url"));else{let t=e.getValue(e.getElement("input[name=pattern]",r));e.setElementActivity(p,!1,!1),o.ajax(s.getOption("pagemanager.ajax.check_candidate_link")).addNonce().onSuccess((t=>{l.showFieldMessage(i,"",!1),e.setElementActivity(p,!0,!1)})).onError((e=>{l.showFieldMessage(i,n.error2string(e))})).send({link:a,pattern:t})}}),1500)}),"input[name=candidate_page_link]"),c("setup","setup"),c("re-optimize","reoptimize")}()})();