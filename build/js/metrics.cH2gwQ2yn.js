/*! For license information please see metrics.cH2gwQ2yn.js.LICENSE.txt */
!function(){const e=PRHelper.getHTML(),t=PRHelper.getType(),n=PRHelper.getHook(),o=PRHelper.getServer(),c=PRHelper.getRequest(),a=PRHelper.getSetting();n.on("load",r);let i={};function r(){i={},c.ajax(a.getOption("ajax.get_pages")).onSuccess((e=>{const n=e;t.isEmpty(n)||l(n)})).onError((e=>{console.log(e)})).addNonce().send()}function l(e,n=0){if(e.hasOwnProperty(n)){const t=e[n].id,o=e[n].url;s(t,o,"desktop").then((()=>{s(t,o,"mobile").then((()=>{l(e,++n)})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e)}))}else t.isEmpty(i)||(o=i,c.ajax(a.getOption("ajax.update_pages")).addNonce().onSuccess(r).send({pages:o}));var o}async function s(n,c,a){return new Promise(((r,l)=>{void 0!==i[n]&&void 0!==i[n][a]&&l("metric already extracted.");const s=o.addParams({"dont-opt":1,"calc-metrics":1,device:a},c),d=e.createElement(`<iframe id="calc_metrics" data-device="${a}"  src="${s}" class="${a}"/>`);d.onload=()=>{const e=d.contentWindow,o=e.opt_lcp,c=Array.from(e.document.getElementsByTagName("img")).filter((t=>{const n=t.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.bottom<=(e.innerHeight||document.documentElement.clientHeight)&&n.right<=(e.innerWidth||document.documentElement.clientWidth)})).map((e=>e.src));console.log(c),t.isEmpty(o)?l("can not detect lcp item."):(void 0===i[n]&&(i[n]={lcp:{},atf_images:{}}),i[n].lcp[a]=o,i[n].atf_images[a]=c,d.remove(),r("lcp item extracted."))},e.append(d,"body")}))}}();