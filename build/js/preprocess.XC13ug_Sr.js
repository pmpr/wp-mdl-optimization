/*! For license information please see preprocess.XC13ug_Sr.js.LICENSE.txt */
!function(){const e=PRHelper.getHTML(),t=PRHelper.getType(),o=PRHelper.getHook(),n=PRHelper.getServer(),r=PRHelper.getRequest(),c=PRHelper.getSetting();o.on("load",l);let i={};function l(){i={},r.ajax(c.getOption("ajax.get_pages")).onSuccess((e=>{const o=e;t.isEmpty(o)||s(o)})).onError((e=>{console.log(e)})).addNonce().send()}function s(e,o=0){if(e.hasOwnProperty(o)){const t=e[o].id,n=e[o].url;d(t,n,"desktop").then((()=>{d(t,n,"mobile").then((()=>{s(e,++o)})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e)}))}else t.isEmpty(i)||(n=i,r.ajax(c.getOption("ajax.update_pages")).addNonce().onSuccess(l).send({pages:n}));var n}async function d(o,r,c){return new Promise(((l,s)=>{void 0!==i[o]&&void 0!==i[o][c]&&s("metric already extracted.");const d=n.addParams({"dont-opt":1,"opt-preprocess":1,device:c},r),m=e.createElement(`<iframe id="calc_metrics" data-device="${c}"  src="${d}" class="${c}"/>`);m.onload=()=>{setTimeout((()=>{const n=m.contentWindow.opt_lcp;if(t.isEmpty(n))s("can not detect lcp item.");else{const r=function(o){let n,r,c={};const i={"sr6-module":"sr6-slide","sr7-module":"sr7-slide","rs-module":"rs-slide"};return t.each(i,((i,l)=>{n=a(o,l,(n=>{const c=n.querySelectorAll(i);if(c.length>0){let i=!1;t.each(c,(t=>{e.isEmpty(t)||(t.hasAttribute("style")?(i&&!p(t,o)&&(t.remove(),console.log("Slide removed",t)),i=!0):(t.remove(),console.log("Slide removed",t)))})),r=n.id;const s=n.tagName.toLowerCase();return n=e.renameElement(n,"div"),e.addClass(n,"pr-opt-clone"),e.addAttribute(n,"style",{position:"relative"}),e.addAttribute(n,"data-opt-type",l),n.id+="_pr_clone",{id:r,tag:s,type:l,html:PRHelper.getTool().minifyHTML(n.outerHTML),path:e.getElementPathSelector(n)}}})),c={...c,...n}})),c}(m.contentWindow),s=a(m.contentWindow,"img, video",(e=>e.src));void 0===i[o]&&(i[o]={lcp:{},sliders:{},atf_images:{}}),i[o].lcp[c]=n,i[o].sliders[c]=r,i[o].atf_images[c]=s,m.remove(),l("preprocess.")}}),6e3)},e.append(m,"body")}))}function a(e,t,o){return Array.from(e.document.querySelectorAll(t)).filter((t=>p(t,e))).map(o)}function p(e,t){const o=e.getBoundingClientRect();return o.top>=0&&o.left>=0&&o.bottom<=(t.innerHeight||t.document.documentElement.clientHeight)&&o.right<=(t.innerWidth||t.document.documentElement.clientWidth)}}();