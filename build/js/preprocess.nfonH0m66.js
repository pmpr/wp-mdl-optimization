/*! For license information please see preprocess.nfonH0m66.js.LICENSE.txt */
!function(){const e=PRHelper.getHTML(),t=PRHelper.getType(),o=PRHelper.getHook(),n=PRHelper.getServer(),c=PRHelper.getRequest(),r=PRHelper.getSetting();o.on("load",i);let s={};function i(){s={},c.ajax(r.getOption("ajax.get_pages")).onSuccess((e=>{const o=e;t.isEmpty(o)||d(o)})).onError((e=>{console.log(e)})).addNonce().send()}function d(e,o=0){if(e.hasOwnProperty(o)){const t=e[o].id,n=e[o].url;l(t,n,"desktop").then((()=>{l(t,n,"mobile").then((()=>{d(e,++o)})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e)}))}else t.isEmpty(s)||(n=s,c.ajax(r.getOption("ajax.update_pages")).addNonce().onSuccess(i).send({pages:n}));var n}async function l(o,c,r){return new Promise(((i,d)=>{void 0!==s[o]&&void 0!==s[o][r]&&d("metric already extracted.");const l=n.addParams({"dont-opt":1,"opt-preprocess":1,device:r},c),p=e.createElement(`<iframe id="calc_metrics" data-device="${r}"  src="${l}" class="${r}"/>`);p.onload=()=>{const n=p.contentWindow,c=n.opt_lcp;if(t.isEmpty(c))d("can not detect lcp item.");else{const d=function(o){let n,c,r={};const s={"sr6-module":"sr6-slide","sr7-module":"sr7-slide","rs-module":"rs-slide"};return t.each(s,((s,i)=>{n=a(o,s,(o=>{const n=e.getElements(i,o);if(n.length>0)return t.each(n,((e,t)=>{t>0&&!a(e)&&e.remove()})),c=o.id,e.addClass(o,"pr-opt-clone"),o.id+="_pr_cloned",{id:c,tag:o.tagName.toLowerCase(),type:s,html:o.outerHTML,path:e.getElementPathSelector(o)}})),r={...r,...n}})),r}(n.document),l=a(n.document,"img, video",(e=>e.src));void 0===s[o]&&(s[o]={lcp:{},sliders:{},atf_images:{}}),s[o].lcp[r]=c,s[o].sliders[r]=d,s[o].atf_images[r]=l,p.remove(),i("preprocess.")}},e.append(p,"body")}))}function a(t,o,n){return Array.from(e.getElements(o,t)).filter((e=>function(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}(e))).map(n)}}();