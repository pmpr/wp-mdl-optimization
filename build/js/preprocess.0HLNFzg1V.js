/*! For license information please see preprocess.0HLNFzg1V.js.LICENSE.txt */
!function(){const e=PRHelper.getHTML(),t=PRHelper.getType(),n=PRHelper.getHook(),o=PRHelper.getServer(),c=PRHelper.getRequest(),s=PRHelper.getSetting();n.on("load",i);let r={};function i(){r={},c.ajax(s.getOption("ajax.get_pages")).onSuccess((e=>{const n=e;t.isEmpty(n)||d(n)})).onError((e=>{console.log(e)})).addNonce().send()}function d(e,n=0){if(e.hasOwnProperty(n)){const t=e[n].id,o=e[n].url;l(t,o,"desktop").then((()=>{l(t,o,"mobile").then((()=>{d(e,++n)})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e)}))}else t.isEmpty(r)||(o=r,c.ajax(s.getOption("ajax.update_pages")).addNonce().onSuccess(i).send({pages:o}));var o}async function l(n,c,s){return new Promise(((i,d)=>{void 0!==r[n]&&void 0!==r[n][s]&&d("metric already extracted.");const l=o.addParams({"dont-opt":1,"opt-preprocess":1,device:s},c),p=e.createElement(`<iframe id="calc_metrics" data-device="${s}"  src="${l}" class="${s}"/>`);p.onload=()=>{setTimeout((()=>{const o=p.contentWindow.opt_lcp;if(t.isEmpty(o))d("can not detect lcp item.");else{const c=function(n){let o,c,s={};const r={"sr6-module":"sr6-slide","sr7-module":"sr7-slide","rs-module":"rs-slide"};return t.each(r,((r,i)=>{o=a(n,i,(n=>{const o=e.getElements(r,n);if(o.length>0)return t.each(o,((e,t)=>{t>0&&!a(e)&&e.remove()})),c=n.id,e.addClass(n,"pr-opt-clone"),n.id+="_pr_cloned",{id:c,tag:n.tagName.toLowerCase(),type:i,html:n.outerHTML,path:e.getElementPathSelector(n)}})),s={...s,...o}})),s}(p.contentWindow),d=a(p.contentWindow,"img, video",(e=>e.src));void 0===r[n]&&(r[n]={lcp:{},sliders:{},atf_images:{}}),r[n].lcp[s]=o,r[n].sliders[s]=c,r[n].atf_images[s]=d,p.remove(),i("preprocess.")}}),4e3)},e.append(p,"body")}))}function a(t,n,o){return Array.from(e.getElements(n,t.document)).filter((e=>function(e,t){const n=e.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.bottom<=(t.innerHeight||t.document.documentElement.clientHeight)&&n.right<=(t.innerWidth||t.document.documentElement.clientWidth)}(e,t))).map(o)}}();